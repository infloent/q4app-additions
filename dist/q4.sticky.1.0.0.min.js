/*
Widget:   q4.sticky
Version:  1.0.0
Compiled: 2017-11-21
*/
!function(a){a.widget("q4.sticky",{options:{version:"1.0.0",stickyElem:null,stickyClass:"js--sticky",layoutElem:".layout",layoutStickyActiveClass:null,disableBreakPoint:null,disableSwitchCondition:null,triggerOffsetAddSticky:0,triggerOffsetRemoveSticky:0,triggerOffsetElemHeightAddSticky:null,triggerOffsetElemHeightRemoveSticky:null,positionOffset:0,positionOffsetElemHeight:null,offsetTopElem:[],offsetTopBreakPoint:[],getTopOffset:q4Defaults.getTopOffset,disabled:!1,onSticky:function(a){},onUnSticky:function(a){},afterSticky:function(a){},beforeSticky:function(a){}},throttleDelay:0,isSticky:!1,isStickyDisabled:!1,_setWidgetProperties:function(){this.$layout=a(this.options.layoutElem),this.$stickyElem=this._setStickyElem()},_create:function(){this._setWidgetProperties(),this._addClass("js--sticky-trigger"),!1===this.options.disabled&&(this._stickyOnScroll(),this._stickyOnResize())},_init:function(){this._enableDisableSticky()},_setOption:function(a,b){if("disabled"===a){var c=this.option("disabled");!0===b&&!1===c?(this.isStickyDisabled=!1,this._removeStickyOnResize(),this._disableSticky()):!1===b&&!0===c&&(this.isStickyDisabled=!0,this._stickyOnResize(),this._enableDisableSticky(),this._addRemoveSticky())}this._super(a,b)},_destroy:function(){this._removeWidgetElemHeight(),this.removeSticky(),a(".js_sticky-appended",this.element).length&&a(".js_sticky-appended",this.element).children().unwrap()},_setStickyElem:function(){var b;if(null===this.options.stickyElem&&1===this.element.children().length)b=this.element.children().first();else if("append"===this.options.stickyElem||0===this.element.children().length)b=this.element.wrapInner('<div class="js_sticky-appended"></div>').children().first();else{if("string"!=typeof this.options.stickyElem||"append"===this.options.stickyElem)throw new Error('"stickyElem" options not corectly set');b=a(this.options.stickyElem,this.element).first()}return this._addClass(b,"js_sticky-elem"),b},_setStickyElemHeightToWidgetElem:function(a){this.element.css("height",this.$stickyElem.outerHeight())},_setWidgetElemHeight:function(){var b=a("img:visible",this.element);this._setStickyElemHeightToWidgetElem(),b.length&&this._on(b,{load:"_setStickyElemHeightToWidgetElem"})},_removeWidgetElemHeight:function(){this.element.css("height","")},positionOffset:function(){var a=this.options.getTopOffset()+this.options.positionOffset;switch(this.options.positionOffsetElemHeight){case"positive":a+=this.$stickyElem.outerHeight();break;case"negative":a-=this.$stickyElem.outerHeight()}return a},_setStickyElemPosition:function(){this.$stickyElem.css("top",this.positionOffset()+"px")},_removeStickyElemPosition:function(){this.$stickyElem.css("top","")},addSticky:function(a){this.isSticky||this._trigger("onSticky",a),this._setStickyElemPosition(),this.isSticky||(this.isSticky=!this.isSticky,this._addClass(this.$stickyElem,this.options.stickyClass),this.options.layoutStickyActiveClass&&this._addClass(this.$layout,this.options.layoutStickyActiveClass)),this._trigger("afterSticky",a)},removeSticky:function(a){this.isSticky&&this._trigger("onUnSticky",a),this.isSticky&&(this.isSticky=!this.isSticky,this._removeClass(this.$stickyElem,this.options.stickyClass),this._removeStickyElemPosition(),this.options.layoutStickyActiveClass&&this._removeClass(this.$layout,this.options.layoutStickyActiveClass)),this._trigger("beforeSticky",a)},disableCondititon:function(){return this.options.disableSwitchCondition===this.window.width()<=this.options.disableBreakPoint},_calcTriggerOffset:function(a,b){var c=this.options.getTopOffset()+a;switch(b){case"positive":c+=this.$stickyElem.outerHeight();break;case"negative":c-=this.$stickyElem.outerHeight()}return c},triggerOffsetAdd:function(){return this._calcTriggerOffset(this.options.triggerOffsetAddSticky,this.options.triggerOffsetElemHeightAddSticky)},triggerOffsetRemove:function(){return this._calcTriggerOffset(this.options.triggerOffsetRemoveSticky,this.options.triggerOffsetElemHeightRemoveSticky)},currentScroll:function(){return this.window.scrollTop()},elemTriggerOffsetTopAdd:function(){return this.element.offset().top-this.triggerOffsetAdd()},elemTriggerOffsetTopRemove:function(){return this.element.offset().top-this.triggerOffsetRemove()},addCondition:function(){return this.currentScroll()>this.elemTriggerOffsetTopAdd()},removeCondition:function(){return this.currentScroll()<=this.elemTriggerOffsetTopRemove()},_addRemoveSticky:function(a){this.disableCondititon()||(this._setWidgetElemHeight(),this.addCondition()?this.addSticky(a):this.removeCondition()&&this.removeSticky(a))},_stickyOnScroll:function(){this._on(this.window,{scroll:"_addRemoveSticky"})},_removeStickyOnScroll:function(){this._off(this.window,"scroll")},_disableSticky:function(){this.isStickyDisabled||(this.isStickyDisabled=!this.isStickyDisabled,this._removeStickyOnScroll(),this._removeWidgetElemHeight(),this.removeSticky())},_enableSticky:function(){this.isStickyDisabled&&(this._stickyOnScroll(),this.isStickyDisabled=!this.isStickyDisabled)},_enableDisableSticky:function(a){this.disableCondititon()?this._disableSticky():this._enableSticky()},_stickyOnResize:function(){this._on(this.window,{resize:this._throttle(function(a){this._addRemoveSticky(a),this._enableDisableSticky(a)},this.throttleDelay)})},_removeStickyOnResize:function(){this._off(this.window,"resize")},_throttle:function(a,b,c){b||(b=250);var d,e;return function(){var f=c||this,g=+new Date,h=arguments;d&&g<d+b?(clearTimeout(e),e=setTimeout(function(){d=g,a.apply(f,h)},b)):(d=g,a.apply(f,h))}}})}(jQuery);